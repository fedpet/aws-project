\documentclass{report}
\usepackage[utf8]{inputenc}
\usepackage{natbib}
\usepackage{graphicx}
\usepackage[italian]{cleveref}
\usepackage[italian]{babel}
\usepackage{subfigure}
\usepackage{wrapfig}
\usepackage{dirtree}
\usepackage{xcolor}
\usepackage[section]{placeins} % figures before next section

\definecolor{codegray}{gray}{0.925}
\newcommand{\code}[1]{\colorbox{codegray}{\texttt{\detokenize{#1}}}}
\newenvironment{codeblock}[1]{\colorbox{codegray}{\texttt{\detokenize{#1}}}}

\title{
    MyWaste \\
    \large Applicazioni e Servizi Web
}

\author{Federico Pettinari - 988120 \{federico.pettinari2@studio.unibo.it\}\\
Hamado Dene - 973128 \{hamado.dene@studio.unibo.it\}}
\date{\today}

\begin{document}

\maketitle
\section{Introduzione}
%Introduzione \citep{adams1995hitchhiker}
Lo scopo del progetto è la realizzazione di un'applicazione web per la gestione dei dati dei rifiuti cittadini ed i relativi conferimenti,
in modo che ogni cittadino possa sapere (anche in tempo reale) la quantità ed il costo dei rifiuti prodotti.
A questo scopo si presume che ogni cassonetto per la raccolta differenziata sia dotato di lettore RFID per poterne identificare
il padrone in modo automatico.

\section{Requisiti}
\begin{itemize}
    \item Progettare e sviluppare una web app per la visualizzazione e gestione dei dati sui rifiuti cittadini
    \item I cassonetti sono dotati di sensore di peso e lettore rfid per identificare l’utente che sta conferendo i rifiuti
    \item La piattaforma deve calcolare il costo mensile in funzione del tipo di rifiuto e peso.
    \item Deve mostrare la notifica del conferimento all’utente
    \item Deve mostrare grafici statistici sul conferimento
    \item La lettura dei sensori dei cassonetti ed il conseguente inserimento dei dati sull'applicazione
    avvengono automaticamente al centro di smistamento, senza bisogno di intervento da parte dell'utente.
\end{itemize}

\section{Design}
\subsection{Architettura}
L'architettura è raffigurata in \Cref{fig:arch}.
Ogni richiesta HTTP viene ricevuta e smistata dal reverse proxy.
Le chiamate che iniziano con /api vengono passate al backend, mentre le altre al frontend.
Questo aiuta a separare frontend e backend in modo trasparente e senza bisogno di utilizzare Cross-Origin Resource Sharing (CORS).

\begin{figure}[h!]
\centering
\includegraphics[width=\textwidth]{arch}
\caption{Architettura}
\label{fig:arch}
\end{figure}

\subsection{Database}
Il modello del database è semplice e raffigurato in \Cref{fig:db}. L'applicazione può avere un numero variabile di account.
Ad ogni account sono associate le proprie notifiche e conferimenti (Waste). Un account oltre ai dati di identificazione
(email e password), ha un ruolo (role) per distinguere amministratori da utenti. Per ogni conferimento vengono memorizzati
la data, il tipo di spazzatura (es. plastica o carta) e la quantità. Per ogni notifica vengono memorizzati la data di creazione,
una flag per sapere se è stata letta, ed il tipo e quantità per i conferimenti.
\begin{figure}[h!]
    \centering
    \includegraphics[width=\textwidth]{db}
    \caption{Modello del database}
    \label{fig:db}
\end{figure}

\subsection{Interfaccia utente}
Per il design dell'interfaccia utente è stato inizialmente sviluppato il mockup raffigurato in \Cref{fig:mockup}, che si è
man mano evoluto a seguito dei test di usabilità effettuati. E' stata prediletta la semplicità e l'immediatezza.

\begin{figure}[h!]
    \centering
    \includegraphics[width=\textwidth]{mockup}
    \caption{Mockup interfaccia utente}
    \label{fig:mockup}
\end{figure}

\section{Tecnologie}
Il progetto utilizza le seguenti tecnologie:
\begin{itemize}
    \item Github Actions - per continous integration
    \item Docker - per disaccoppiare il software dal sistema operativo e facilitarne il porting ed installazione.
    \item nginx - utilizzato come reverse proxy
    \item MongoDB - database non relazionale di documenti
    \item Node - come server web sia per frontend e backend
    \item Express - framework per gestire chiamate e routes HTTP
    \item Mongoose - come libreria di object modeling per mongodb
    \item Mocha e Supertest - per testing automatizzato nel backend
    \item mongodb-memory-server - per utilizzare un database mongodb in memoria, in modo da velocizzare l'esecuzione dei test
    \item bcrypt - per criptare le password degli utenti ai fini di sicurezza
    \item express-jwt - libreria per facilitare l'uso di tokens JWT utilizzati nel sistema di login utente
    \item Nodemon - tool che riavvia le applicazioni Node ad ogni modifica del sorgente
    per velocizzarne lo sviluppo e debugging
    \item React - framework per frontend
    \item SCSS - libreria pre-processore di CSS per facilitarne il riuso
    \item Bootstrap - framework per CSS
\end{itemize}

%\section{Codice}
%Solo aspetti rilevanti.
%TODO: ????????????

\section{Test}
\subsection{Codice}
A livello di codice sono state adottate tecniche di continous integration con le Github Actions ed il framework e librerie di testing
Mocha e Supertest.
Ad ogni push di codice viene eseguita automaticamente la suite di testing opportunatamente creata.
Questo sistema aiuta a prevenire regressioni e facilita la manutenzione.
\subsection{Interfaccia}
Il progetto è stato testato in modalità Cognitive Walkthrough con i seguenti task:
\dirtree{%
.1 Visualizzazione e comprensione della propria dashboard.
    .2 Login.
    .2 Individuazione dashboard.
    .2 Comprensione.
        .3 Individuazione costo mensile.
        .3 Individuazione quantità di spazzatura conferita in un determinato mese.
        .3 Individuazione numero, data, e dettagli dei conferimenti avvenuti.
    .2 Logout.
.1 Ricevuta notifica a seguito di un conferimento.
.1 Visualizzazione e comprensione dashboard per amministratori.
    .2 Individuazione lista utenti.
    .2 Individuazione quantità e ripartizione dei vari tipi di spazzatura in un determinato mese.
.1 Creazione di un nuovo utente.
    2. Gestione dei casi con input non valido (es{.} in caso di dati duplicati l'utente è in grado di capire cosa fare?).
}
Infine, una volta creato un prototipo funzionante e risolti i primi problemi individuati dal team di sviluppo,
sono stati effettuati Usability Tests con 5 potenziali veri utenti. Ad ognuno di essi è stato chiesto di effettuare i task
sopracitati senza però essere messi al corrente degli step intermedi. In questo modo è stato possibile osservare quanto fosse
intuitiva l'interfaccia ed apportare migliorie.
TODO: descrivere migliorie


\section{Deployment}
%Rilascio, installazione e messa in funzione.
Il progetto può essere scaricato con \code{git clone https://github.com/fedpet/aws-project.git} ed avviato con
\code{docker compose up} nella sua cartella root. A questo punto basterà aprire localhost con un browser web per
vederne l'interfaccia.

\section{Dashboard}
Riportiamo in seguito alcuni estratti delle due dashboard.
La prima pagina che si apre quando proviamo ad accedere al frontend è quello di login.
Quando si inserisce lo username e la password, verrà caricato una dashboard in base al role.
\begin{figure}[h!]
    \begin{center}
        \includegraphics[width=1.0\textwidth]{images/login.PNG}  \end{center}
    \caption{MyWaste: login page}
    \label{fig: login}
\end{figure}
Qualora fossimo degli utenti standard avremo dunque:
\begin{figure}[h!]
    \begin{center}
        \includegraphics[width=1.0\textwidth]{images/userDashboard.PNG}  \end{center}
    \caption{MyWaste: user dashboard}
    \label{fig: userDashboard}
\end{figure}
\begin{figure}[h!]
    \begin{center}
        \includegraphics[width=1.0\textwidth]{images/userProfile.PNG}  \end{center}
    \caption{MyWaste: user profile}
    \label{fig: userProfile}
\end{figure}
\begin{figure}[h!]
    \begin{center}
        \includegraphics[width=1.0\textwidth]{images/notificheConferimento.PNG}  \end{center}
    \caption{MyWaste: notifiche conferimento}
    \label{fig: notify}
\end{figure}
Invece per gli utenti admin:
\begin{figure}[h!]
    \begin{center}
        \includegraphics[width=1.0\textwidth]{images/adminDashboard.PNG}  \end{center}
    \caption{MyWaste admin: admin dashboard}
    \label{fig: adminDashboard}
\end{figure}
\begin{figure}[h!]
    \begin{center}
        \includegraphics[width=1.0\textwidth]{images/updateUserData.PNG}  \end{center}
    \caption{MyWaste admin: user update}
    \label{fig: userUpdate}
\end{figure}
\begin{figure}[h!]
    \begin{center}
        \includegraphics[width=1.0\textwidth]{images/addNewUser.PNG}  \end{center}
    \caption{MyWaste admin: add new user}
    \label{fig: addNewUser}
\end{figure}

%TODO: rilascio di immagini docker senza clonare la repo
\section{Conclusioni}
In conclusione pensiamo che questo progetto ci abbia aiutato a incrementare notevolmente la nostra conoscenza del mondo web
e sopratutto aiutato a migliorare le nostre capacità di lavoro in team.
Nonostante l'aspetto lavorativo ci abbia limitati a livello di tempo, siamo riusciti a strutturare il progetto in modo tale
che ognuno potesse lavorare nel suo tempo libero senza la neccessità di dover coinvolgere continuamente gli altri menbri.
Su questo aspetto l'uso di github ci ha dato un grossa mano. Abbiamo definito inizialmente una lista di issue da implementare.
Da tale lista, ognuno poteva prendere in carico un issue, risolverlo e creare un pull request. Dopo aver creato la pull request,
quest'ultimo prima di essere mergiato doveva essere revisionato da almeno uno dei menbri del team e tutti i test automatici
dovevano dare esito positivo.


%\bibliographystyle{plain}
%\bibliography{references}
\end{document}
